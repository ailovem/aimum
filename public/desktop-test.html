<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>æµ‹è¯•æ¡Œé¢åˆ›å»º</title>
</head>
<body style="background: #1a1a1a; color: #fff; font-family: monospace; padding: 20px;">
  <h2>ğŸ–¥ï¸ æ¡Œé¢æ–‡ä»¶æµ‹è¯•</h2>
  
  <button onclick="getDesktop()" style="padding: 10px 20px; margin: 5px;">1. è·å–æ¡Œé¢è·¯å¾„</button>
  <button onclick="createOnDesktop()" style="padding: 10px 20px; margin: 5px;">2. åˆ›å»ºæ–‡ä»¶åˆ°æ¡Œé¢</button>
  <button onclick="listDesktop()" style="padding: 10px 20px; margin: 5px;">3. æŸ¥çœ‹æ¡Œé¢æ–‡ä»¶</button>
  <button onclick="deleteTestFile()" style="padding: 10px 20px; margin: 5px;">4. åˆ é™¤æµ‹è¯•æ–‡ä»¶</button>
  
  <pre id="output" style="background: #0d0d0d; padding: 15px; margin-top: 20px; border-radius: 5px; white-space: pre-wrap;"></pre>
  
  <script>
    async function getDesktop() {
      show('è·å–æ¡Œé¢è·¯å¾„...');
      try {
        const res = await fetch('/api/execute', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({command: 'echo %USERPROFILE%\\Desktop'})
        });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        show('é”™è¯¯: ' + e.message);
      }
    }
    
    async function createOnDesktop() {
      show('åœ¨æ¡Œé¢åˆ›å»ºæµ‹è¯•æ–‡ä»¶...');
      try {
        const res = await fetch('/api/execute', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({command: 'echo è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ > %USERPROFILE%\\Desktop\\å°ç™½ç†Šæµ‹è¯•.txt'})
        });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        show('é”™è¯¯: ' + e.message);
      }
    }
    
    async function listDesktop() {
      show('æŸ¥çœ‹æ¡Œé¢æ–‡ä»¶...');
      try {
        const res = await fetch('/api/execute', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({command: 'dir %USERPROFILE%\\Desktop'})
        });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        show('é”™è¯¯: ' + e.message);
      }
    }
    
    async function deleteTestFile() {
      show('åˆ é™¤æµ‹è¯•æ–‡ä»¶...');
      try {
        const res = await fetch('/api/execute', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({command: 'del /q "%USERPROFILE%\\Desktop\\å°ç™½ç†Šæµ‹è¯•.txt"'})
        });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        show('é”™è¯¯: ' + e.message);
      }
    }
    
    function show(msg) {
      document.getElementById('output').textContent = msg + '\n\næ‰§è¡Œä¸­...';
    }
    
    function showResult(data) {
      let text = '';
      if (data.success) {
        text += 'âœ… æˆåŠŸ!\n';
        text += 'è¾“å‡º: ' + (data.output || '(ç©º)');
      } else {
        text += 'âŒ å¤±è´¥\n';
        text += 'é”™è¯¯: ' + (data.error || 'æœªçŸ¥');
      }
      document.getElementById('output').textContent = text;
    }
  </script>
</body>
</html>
